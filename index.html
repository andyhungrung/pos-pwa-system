<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#2563eb" />
    <title>POSÈä∑ÂîÆÁ≥ªÁµ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #f3f4f6; }
        .container { height: 100vh; display: flex; flex-direction: column; }
        .header { background: white; padding: 16px; border-bottom: 1px solid #e5e7eb; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .nav { display: flex; justify-content: space-between; align-items: center; }
        .title { font-size: 24px; font-weight: bold; color: #1f2937; }
        .nav-buttons { display: flex; gap: 8px; }
        .nav-btn { padding: 8px 16px; border-radius: 6px; border: none; cursor: pointer; font-size: 14px; font-weight: 500; transition: all 0.2s; }
        .nav-btn.active { background: #2563eb; color: white; }
        .nav-btn:not(.active) { background: #e5e7eb; color: #374151; }
        .nav-btn:hover:not(.active) { background: #d1d5db; }
        .main { flex: 1; overflow: hidden; }
        .page { display: none; height: 100%; }
        .page.active { display: flex; flex-direction: column; }
        .page-content { flex: 1; padding: 16px; overflow-y: auto; }
        .section-title { font-size: 20px; font-weight: 600; margin-bottom: 16px; }
        .card { background: white; padding: 16px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 16px; }
        .input { padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; width: 100%; }
        .input:focus { outline: none; border-color: #3b82f6; }
        .button { padding: 12px 16px; background: #2563eb; color: white; border: none; border-radius: 6px; font-weight: 500; cursor: pointer; }
        .button:hover { background: #1d4ed8; }
        .button:disabled { opacity: 0.5; cursor: not-allowed; }
        .button-green { background: #16a34a; }
        .button-green:hover { background: #15803d; }
        .button-red { background: #dc2626; }
        .button-red:hover { background: #b91c1c; }
        .button-gray { background: #6b7280; }
        .button-gray:hover { background: #4b5563; }
        .sales-layout { flex: 1; display: flex; flex-direction: column; }
        @media (min-width: 769px) { .sales-layout { flex-direction: row; } }
        .products-area { flex: 2; padding: 16px; overflow-y: auto; }
        .cart-area { flex: 1; background: white; border-top: 2px solid #e5e7eb; padding: 16px; min-height: 200px; display: flex; flex-direction: column; }
        @media (min-width: 769px) { .cart-area { width: 320px; border-top: none; border-left: 1px solid #e5e7eb; } }
        .manual-input { background: white; padding: 16px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 16px; }
        .input-group { display: flex; gap: 8px; flex-direction: column; }
        @media (min-width: 769px) { .input-group { flex-direction: row; } }
        .product-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        @media (min-width: 769px) { .product-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (min-width: 1024px) { .product-grid { grid-template-columns: repeat(4, 1fr); } }
        .product-card { background: white; padding: 16px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); cursor: pointer; text-align: center; min-height: 80px; display: flex; flex-direction: column; justify-content: center; border: 2px solid transparent; }
        .product-card:hover { border-color: #60a5fa; }
        .cart-items { flex: 1; overflow-y: auto; margin-bottom: 12px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f3f4f6; }
        .cart-controls { display: flex; gap: 4px; align-items: center; }
        .control-btn { width: 28px; height: 28px; background: #e5e7eb; border: none; border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; }
        .table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }
        .table th { background: #f9fafb; font-weight: 600; }
        .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 16px; }
        .modal-content { background: white; padding: 24px; border-radius: 8px; width: 100%; max-width: 400px; }
        .hidden { display: none; }
        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px; }
        @media (min-width: 769px) { .stats-grid { grid-template-columns: repeat(4, 1fr); } }
        .stat-card { background: white; padding: 20px; border-radius: 8px; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .stat-number { font-size: 24px; font-weight: bold; color: #2563eb; }
        .stat-label { font-size: 12px; color: #6b7280; margin-top: 4px; }
        .charts-container { display: grid; grid-template-columns: 1fr; gap: 24px; margin-bottom: 24px; }
        @media (min-width: 1024px) { .charts-container { grid-template-columns: 1fr 1fr; } }
        .chart-card { background: white; padding: 24px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: all 0.3s ease; }
        .chart-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .chart-title { font-size: 18px; font-weight: 700; color: #1f2937; margin-bottom: 4px; }
        .chart-subtitle { font-size: 14px; color: #6b7280; margin-bottom: 20px; }
        .chart-wrapper { position: relative; height: 300px; margin-bottom: 20px; }
        .chart-legend { display: grid; grid-template-columns: 1fr; gap: 8px; max-height: 200px; overflow-y: auto; }
        .legend-item { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: #f9fafb; border-radius: 6px; font-size: 14px; }
        .legend-color { width: 16px; height: 16px; border-radius: 4px; margin-right: 8px; }
        .legend-info { display: flex; align-items: center; flex: 1; }
        .legend-value { font-weight: 600; color: #374151; }
        .legend-percentage { font-size: 12px; color: #6b7280; margin-left: 4px; }
        .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 200px; color: #9ca3af; }
        .empty-state-icon { font-size: 48px; margin-bottom: 12px; }
        .empty-state-text { font-size: 16px; font-weight: 500; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="nav">
                <h1 class="title">POSÈä∑ÂîÆÁ≥ªÁµ±</h1>
                <div class="nav-buttons">
                    <button class="nav-btn active" onclick="POS.showPage('sales')">Èä∑ÂîÆ</button>
                    <button class="nav-btn" onclick="POS.showPage('products')">ÂïÜÂìÅ</button>
                    <button class="nav-btn" onclick="POS.showPage('reports')">Â†±Ë°®</button>
                    <button class="nav-btn" onclick="POS.showPage('backup')">ÂÇô‰ªΩ</button>
                </div>
            </div>
        </div>
        <div class="main">
            <div id="salesPage" class="page active">
                <div class="sales-layout">
                    <div class="products-area">
                        <h2 class="section-title">ÂïÜÂìÅÈÅ∏Êìá</h2>
                        <div class="manual-input">
                            <h3 style="font-weight: 500; margin-bottom: 12px;">Âø´ÈÄüÊñ∞Â¢ûÂïÜÂìÅ</h3>
                            <div class="input-group">
                                <input id="productName" type="text" class="input" placeholder="ÂïÜÂìÅÂêçÁ®±" style="flex: 1;">
                                <input id="productPrice" type="number" class="input" placeholder="ÂÉπÊ†º" step="0.01" style="width: 120px;">
                                <button onclick="POS.addManualProduct()" class="button button-green">Êñ∞Â¢û</button>
                            </div>
                        </div>
                        <div id="productGrid" class="product-grid"></div>
                    </div>
                    <div class="cart-area">
                        <h2 class="section-title">Ë≥ºÁâ©Ëªä</h2>
                        <div id="cartItems" class="cart-items">
                            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #6b7280;">
                                <div style="font-size: 32px; margin-bottom: 8px;">üõí</div>
                                <p>Ë≥ºÁâ©ËªäÊòØÁ©∫ÁöÑ</p>
                            </div>
                        </div>
                        <div style="padding-top: 12px; border-top: 1px solid #e5e7eb;">
                            <div id="totalAmount" style="font-size: 18px; font-weight: bold; margin-bottom: 12px;">Á∏ΩË®à: $0</div>
                            <button onclick="POS.checkout()" class="button" style="width: 100%;" disabled id="checkoutBtn">ÁµêÂ∏≥</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="productsPage" class="page">
                <div class="page-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <h2 class="section-title" style="margin: 0;">ÂïÜÂìÅÁÆ°ÁêÜ</h2>
                        <button class="button button-green" onclick="POS.showProductModal()">Êñ∞Â¢ûÂïÜÂìÅ</button>
                    </div>
                    <div class="card">
                        <table class="table"><thead><tr><th>ÂïÜÂìÅÂêçÁ®±</th><th>ÂÉπÊ†º</th><th>Êìç‰Ωú</th></tr></thead><tbody id="productsTableBody"></tbody></table>
                    </div>
                </div>
            </div>
            <div id="reportsPage" class="page">
                <div class="page-content">
                    <h2 class="section-title">Èä∑ÂîÆÂ†±Ë°®</h2>
                    <div class="stats-grid">
                        <div class="stat-card"><div id="totalProducts" class="stat-number">0</div><div class="stat-label">ÂïÜÂìÅÁ∏ΩÊï∏</div></div>
                        <div class="stat-card"><div id="totalSales" class="stat-number">0</div><div class="stat-label">Èä∑ÂîÆÁ≠ÜÊï∏</div></div>
                        <div class="stat-card"><div id="totalRevenue" class="stat-number">$0</div><div class="stat-label">Á∏ΩÁáüÊî∂</div></div>
                        <div class="stat-card"><div id="avgOrder" class="stat-number">$0</div><div class="stat-label">Âπ≥ÂùáÂÆ¢ÂñÆÂÉπ</div></div>
                    </div>
                    <div class="charts-container">
                        <div class="chart-card">
                            <div class="chart-title">üìä ÂïÜÂìÅÈä∑ÂîÆÊï∏ÈáèÂàÜÊûê</div>
                            <div class="chart-subtitle">‰æùÈä∑ÂîÆÊï∏ÈáèÁµ±Ë®àÂêÑÂïÜÂìÅÂç†ÊØî</div>
                            <div class="chart-wrapper">
                                <canvas id="quantityChart"></canvas>
                                <div id="quantityEmpty" class="empty-state hidden"><div class="empty-state-icon">üìà</div><div class="empty-state-text">Êö´ÁÑ°Èä∑ÂîÆÊï∏Êìö</div></div>
                            </div>
                            <div id="quantityLegend" class="chart-legend"></div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">üí∞ ÂïÜÂìÅÈä∑ÂîÆÈáëÈ°çÂàÜÊûê</div>
                            <div class="chart-subtitle">‰æùÈä∑ÂîÆÈáëÈ°çÁµ±Ë®àÂêÑÂïÜÂìÅÂç†ÊØî</div>
                            <div class="chart-wrapper">
                                <canvas id="revenueChart"></canvas>
                                <div id="revenueEmpty" class="empty-state hidden"><div class="empty-state-icon">üí∏</div><div class="empty-state-text">Êö´ÁÑ°ÁáüÊî∂Êï∏Êìö</div></div>
                            </div>
                            <div id="revenueLegend" class="chart-legend"></div>
                        </div>
                    </div>
                    <div class="card">
                        <h3 style="font-weight: 600; margin-bottom: 16px;">Èä∑ÂîÆË®òÈåÑ</h3>
                        <div id="salesHistory" style="max-height: 300px; overflow-y: auto;"><p style="text-align: center; color: #6b7280; padding: 40px;">Êö´ÁÑ°Èä∑ÂîÆË®òÈåÑ</p></div>
                    </div>
                </div>
            </div>
            <div id="backupPage" class="page">
                <div class="page-content">
                    <h2 class="section-title">Ë≥áÊñôÂÇô‰ªΩËàáÈÇÑÂéü</h2>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 16px;">
                        <div class="card">
                            <h3 style="font-weight: 600; margin-bottom: 12px;">ÂÇô‰ªΩË≥áÊñô</h3>
                            <p style="color: #6b7280; margin-bottom: 16px;">Â∞áÊâÄÊúâÂïÜÂìÅÂíåÈä∑ÂîÆË≥áÊñôÂåØÂá∫ÁÇ∫Ê™îÊ°à</p>
                            <button class="button" onclick="POS.exportData()">ÂåØÂá∫Ë≥áÊñô</button>
                        </div>
                        <div class="card">
                            <h3 style="font-weight: 600; margin-bottom: 12px;">ÈÇÑÂéüË≥áÊñô</h3>
                            <p style="color: #6b7280; margin-bottom: 16px;">ÂæûÂÇô‰ªΩÊ™îÊ°àÈÇÑÂéüË≥áÊñô</p>
                            <input type="file" id="importFile" accept=".json" style="margin-bottom: 12px;">
                            <button class="button button-gray" onclick="POS.importData()">ÂåØÂÖ•Ë≥áÊñô</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="productModal" class="modal hidden">
        <div class="modal-content">
            <h3 id="modalTitle" style="font-size: 18px; font-weight: 600; margin-bottom: 16px;">Êñ∞Â¢ûÂïÜÂìÅ</h3>
            <div style="margin-bottom: 16px;"><label style="display: block; margin-bottom: 4px; font-weight: 500;">ÂïÜÂìÅÂêçÁ®±</label><input id="modalProductName" type="text" class="input"></div>
            <div style="margin-bottom: 20px;"><label style="display: block; margin-bottom: 4px; font-weight: 500;">ÂÉπÊ†º</label><input id="modalProductPrice" type="number" class="input" step="0.01"></div>
            <div style="display: flex; gap: 8px;">
                <button class="button" onclick="POS.saveProduct()">ÂÑ≤Â≠ò</button>
                <button class="button button-gray" onclick="POS.closeProductModal()">ÂèñÊ∂à</button>
            </div>
        </div>
    </div>
    <div id="alertModal" class="modal hidden">
        <div class="modal-content">
            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">ÊèêÁ§∫Ë®äÊÅØ</h3>
            <p id="alertMessage" style="color: #6b7280; margin-bottom: 16px;"></p>
            <button class="button" onclick="POS.closeAlert()">Á¢∫ÂÆö</button>
        </div>
    </div>
    <script>
var POS=function(){var e=[],t=[],r=0,a=[],o=null,n=null,s=null,i=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#AED6F1","#A9DFBF","#F8C471","#D7BDE2"];function d(){return new Promise(function(e,t){var r=indexedDB.open("POSSystemDB",2);r.onerror=function(){return t(r.error)},r.onsuccess=function(){return e(r.result)},r.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains("products")||t.createObjectStore("products",{keyPath:"id"}),t.objectStoreNames.contains("sales")||t.createObjectStore("sales",{keyPath:"id"})}})}async function c(e,t,r){void 0===r&&(r=null);try{var a=await d(),o=a.transaction([e],"getAll"===t?"readonly":"readwrite").objectStore(e),n=void 0;switch(t){case"add":n=o.add(r);break;case"put":n=o.put(r);break;case"delete":n=o.delete(r);break;case"getAll":n=o.getAll()}return new Promise(function(e,t){n.onsuccess=function(){return e(n.result)},n.onerror=function(){return t(n.error)}})}catch(e){return console.error("DBÊìç‰ΩúÂ§±Êïó:",e),null}}function u(r){console.log("ÂàáÊèõÂà∞:",r),document.querySelectorAll(".page").forEach(function(e){e.classList.remove("active")}),document.querySelectorAll(".nav-btn").forEach(function(e){e.classList.remove("active")});var e=document.getElementById(r+"Page");switch(e&&e.classList.add("active"),document.querySelectorAll(".nav-btn").forEach(function(e){var t=e.textContent.trim();("Èä∑ÂîÆ"===t&&"sales"===r||"ÂïÜÂìÅ"===t&&"products"===r||"Â†±Ë°®"===t&&"reports"===r||"ÂÇô‰ªΩ"===t&&"backup"===r)&&e.classList.add("active")}),r){case"products":h();break;case"reports":v(),setTimeout(function(){return P()},100)}}function l(e){document.getElementById("alertMessage").textContent=e,document.getElementById("alertModal").classList.remove("hidden")}async function p(){e=(await c("products","getAll"))||[],m()}async function f(){a=(await c("sales","getAll"))||[]}function m(){var t=document.getElementById("productGrid");t.innerHTML="",e.forEach(function(e){var r=document.createElement("div");r.className="product-card",r.innerHTML='<div style="font-weight: 500; margin-bottom: 4px;">'+e.name+'</div><div style="color: #2563eb; font-weight: bold;">$'+e.price+"</div>",r.onclick=function(){return g(e)},t.appendChild(r)})}function h(){var t=document.getElementById("productsTableBody");if(t.innerHTML="",0===e.length)t.innerHTML='<tr><td colspan="3" style="text-align: center; color: #6b7280; padding: 40px;">Êö´ÁÑ°ÂïÜÂìÅË≥áÊñô</td></tr>';else{e.forEach(function(e){var r=document.createElement("tr");r.innerHTML="<td>"+e.name+"</td><td>$"+e.price+'</td><td><button class="button" onclick="POS.editProduct(\''+e.id+'\')" style="padding: 6px 12px; font-size: 12px; margin-right: 8px;">Á∑®ËºØ</button><button class="button button-red" onclick="POS.deleteProduct(\''+e.id+'\')" style="padding: 6px 12px; font-size: 12px;">Âà™Èô§</button></td>',t.appendChild(r)})}}function g(e){var r=t.find(function(e){return e.id===e.id});r?r.quantity+=1:t.push(Object.assign({},e,{quantity:1})),y()}function y(){var r=document.getElementById("cartItems"),a=document.getElementById("totalAmount"),e=document.getElementById("checkoutBtn");0===t.length?(r.innerHTML='<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #6b7280;"><div style="font-size: 32px; margin-bottom: 8px;">üõí</div><p>Ë≥ºÁâ©ËªäÊòØÁ©∫ÁöÑ</p></div>',e.disabled=!0):(r.innerHTML="",t.forEach(function(e){r.appendChild(function(e){var t=document.createElement("div");return t.className="cart-item",t.innerHTML='<div style="flex: 1;"><div style="font-weight: 500; font-size: 14px;">'+e.name+'</div><div style="font-size: 12px; color: #6b7280;">$'+e.price+" √ó "+e.quantity+'</div></div><div class="cart-controls"><button class="control-btn" onclick="POS.updateQuantity(\''+e.id+"',"+e.quantity+'-1)">-</button><span style="width: 32px; text-align: center; font-size: 14px;">'+e.quantity+'</span><button class="control-btn" onclick="POS.updateQuantity(\''+e.id+"',"+e.quantity+'+1)">+</button><button class="control-btn" onclick="POS.removeFromCart(\''+e.id+'\')" style="background: #fef2f2; color: #dc2626;">√ó</button></div>',t}(e))}),e.disabled=!1),r=t.reduce(function(e,t){return e+t.price*t.quantity},0),a.textContent="Á∏ΩË®à: $"+r}function b(e,t){t<=0?E(e):((r=t.find(function(e){return e.id===e}))&&(r.quantity=t),y());var r}function E(r){t=t.filter(function(e){return e.id!==r}),y()}async function L(){if(0!==t.length){var e={id:Date.now().toString(),items:t.slice(),total:r=t.reduce(function(e,t){return e+t.price*t.quantity},0),timestamp:(new Date).toISOString()};await c("sales","add",e),a.push(e),l("ÁµêÂ∏≥ÊàêÂäüÔºÅÁ∏ΩÈáëÈ°çÔºö$"+r),t=[],y()}}function q(e){void 0===e&&(e=null),o=e?e.id:null,document.getElementById("modalTitle").textContent=e?"Á∑®ËºØÂïÜÂìÅ":"Êñ∞Â¢ûÂïÜÂìÅ",document.getElementById("modalProductName").value=e?e.name:"",document.getElementById("modalProductPrice").value=e?e.price:"",document.getElementById("productModal").classList.remove("hidden")}async function T(){var t=document.getElementById("modalProductName").value.trim(),r=parseFloat(document.getElementById("modalProductPrice").value);if(t&&r){var a={id:o||Date.now().toString(),name:t,price:r};await c("products","put",a),o?-1!==(t=e.findIndex(function(e){return e.id===o}))&&(e[t]=a):e.push(a),m(),h(),document.getElementById("productModal").classList.add("hidden"),o=null,l(o?"ÂïÜÂìÅÊõ¥Êñ∞ÊàêÂäü":"ÂïÜÂìÅÊñ∞Â¢ûÊàêÂäü")}else l("Ë´ãËº∏ÂÖ•ÂïÜÂìÅÂêçÁ®±ÂíåÂÉπÊ†º")}function k(t){var r=e.find(function(e){return e.id===t});r&&q(r)}async function S(t){confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§ÂïÜÂìÅÂóéÔºü")&&(await c("products","delete",t),e=e.filter(function(e){return e.id!==t}),m(),h(),l("ÂïÜÂìÅÂà™Èô§ÊàêÂäü"))}async function B(){console.log("Âø´ÈÄüÊñ∞Â¢ûÂïÜÂìÅ");var t=document.getElementById("productName").value.trim(),r=parseFloat(document.getElementById("productPrice").value);if(t&&r){var a={id:Date.now().toString(),name:t,price:r};await c("products","put",a),e.push(a),g(a),document.getElementById("productName").value="",document.getElementById("productPrice").value="",m()}else l("Ë´ãËº∏ÂÖ•ÂïÜÂìÅÂêçÁ®±ÂíåÂÉπÊ†º")}function P(){var r,t,e,a,o;console.log("Êõ¥Êñ∞ÂúìÈ§ÖÂúñ"),n&&(n.destroy(),n=null),s&&(s.destroy(),s=null);var i={};if(a.forEach(function(r){r.items.forEach(function(e){i[e.name]||(i[e.name]={quantity:0,revenue:0}),i[e.name].quantity+=e.quantity,i[e.name].revenue+=e.quantity*e.price})}),0===(r=Object.keys(i)).length)return document.getElementById("quantityEmpty").classList.remove("hidden"),document.getElementById("revenueEmpty").classList.remove("hidden"),document.getElementById("quantityChart").style.display="none",document.getElementById("revenueChart").style.display="none",document.getElementById("quantityLegend").innerHTML="",void(document.getElementById("revenueLegend").innerHTML="");document.getElementById("quantityEmpty").classList.add("hidden"),document.getElementById("revenueEmpty").classList.add("hidden"),document.getElementById("quantityChart").style.display="block",document.getElementById("revenueChart").style.display="block";var d=r.map(function(e){return i[e].quantity}),c=r.map(function(e){return i[e].revenue}),u=r.map(function(e,t){return i[t%i.length]}),l=r.map(function(e,t){return{name:e,quantity:d[t],color:u[t]}}).sort(function(e,t){return t.quantity-e.quantity}),p=r.map(function(e,t){return{name:e,revenue:c[t],color:u[t]}}).sort(function(e,t){return t.revenue-e.revenue});n=(e="quantityChart",t=l.map(function(e){return e.quantity}),a=l.map(function(e){return e.name}),o=l.map(function(e){return e.color}),new Chart(document.getElementById(e).getContext("2d"),{type:"pie",data:{labels:a,datasets:[{data:t,backgroundColor:o,borderColor:"#ffffff",borderWidth:2,hoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"white",bodyColor:"white",borderColor:"#2563eb",borderWidth:1,callbacks:{label:function(e){var t=e.label,r=e.formattedValue,a=(100*e.parsed/e.dataset.data.reduce(function(e,t){return e+t})).toFixed(1);return t+": "+r+" ("+a+"%)"}}}},animation:{animateRotate:!0,duration:1500}}})),s=function(e,t,r,a){return new Chart(document.getElementById(e).getContext("2d"),{type:"pie",data:{labels:r,datasets:[{data:t,backgroundColor:a,borderColor:"#ffffff",borderWidth:2,hoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",
